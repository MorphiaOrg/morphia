<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.66.0" />
    <meta name="description" content="">


    <link rel="icon" href="/2.0.0-SNAPSHOT/images/favicon.png" type="image/png">

    <title>Querying :: Morphia</title>

    
    <link href="/2.0.0-SNAPSHOT/css/nucleus.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/fontawesome-all.min.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/hybrid.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/featherlight.min.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/perfect-scrollbar.min.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/auto-complete.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/atom-one-dark-reasonable.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/theme.css?1584105437" rel="stylesheet">
    <link href="/2.0.0-SNAPSHOT/css/hugo-theme.css?1584105437" rel="stylesheet">
    

    <script src="/2.0.0-SNAPSHOT/js/jquery-3.3.1.min.js?1584105437"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    <link href="/2.0.0-SNAPSHOT/css/java.css" rel="stylesheet">
<link href="/2.0.0-SNAPSHOT/css/theme-green.css" rel="stylesheet">

<style>
    :root {
        --MAIN-TEXT-color:#004042;  
        --MAIN-TITLES-TEXT-color: #004042;  
        --MAIN-LINK-color:#006cbc;  
        --MAIN-LINK-HOVER-color:#3f6d2c;  
        --MAIN-ANCHOR-color: #599a3e;  

        --MENU-HEADER-BG-color:#004042;  
        --MENU-HEADER-BORDER-color:#6ca439;  

        --MENU-SEARCH-BG-color:#006264;  
        --MENU-SEARCH-BOX-color: #84c767;  
        --MENU-SEARCH-BOX-ICONS-color: #c7f7c4;  

        --MENU-SECTIONS-ACTIVE-BG-color:#1b211c;  
        --MENU-SECTIONS-BG-color:#222723;  
        --MENU-SECTIONS-LINK-color: #ccc;  
        --MENU-SECTIONS-LINK-HOVER-color: #e6e6e6;   
        --MENU-SECTION-ACTIVE-CATEGORY-color: #777;  
        --MENU-SECTION-ACTIVE-CATEGORY-BG-color: #f3f4eb;  

        --MENU-VISITED-color: #599a3e;  
        --MENU-SECTION-HR-color: #18211c;  
    }

    body {
        background-color: var(--MENU-SECTION-ACTIVE-CATEGORY-BG-color);
        padding-top: 0;
    }

    h1 {
        color: var(--MAIN-TITLES-TEXT-color) !important;
    }

    strong {
        color: var(--MAIN-TITLES-TEXT-color) !important;
    }

    #top-bar-sticky-wrapper {
        visibility: hidden !important;
        min-height: 0;
    }

</style>

  </head>
  <body class="" data-url="/2.0.0-SNAPSHOT/guides/querying/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/2.0.0-SNAPSHOT">
    <img src="/2.0.0-SNAPSHOT/images/logo.png" alt="Morphia Logo"/>
</a>
<span id="version-tag">Morphia 2.0.0-SNAPSHOT</span>

    </div>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/2.0.0-SNAPSHOT/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/2.0.0-SNAPSHOT/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/getting-started/installation-guide/" title="Installation Guide" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/getting-started/installation-guide/">
        Installation Guide
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/getting-started/quick-tour/" title="Quick Tour" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/getting-started/quick-tour/">
        Quick Tour
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/getting-started/migration/" title="Migration Guide" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/getting-started/migration/">
        Migration Guide
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/2.0.0-SNAPSHOT/guides/" title="Reference Guides" class="dd-item 
        parent
        
        
        ">
      <a href="/2.0.0-SNAPSHOT/guides/">
          Reference Guides
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/annotations/" title="Annotations" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/annotations/">
        Annotations
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/aggregation/" title="Aggregation" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/aggregation/">
        Aggregation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/configuration/" title="Configuration" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/configuration/">
        Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/indexing/" title="Indexing" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/indexing/">
        Indexing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/lifecyclemethods/" title="Life Cycle Methods" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/lifecyclemethods/">
        Life Cycle Methods
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/querying/" title="Querying" class="dd-item active">
        <a href="/2.0.0-SNAPSHOT/guides/querying/">
        Querying
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/querying-old/" title="Querying (Deprecated)" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/querying-old/">
        Querying (Deprecated)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/references/" title="References" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/references/">
        References
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/schemavalidation/" title="Schema Validation" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/schemavalidation/">
        Schema Validation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/textsearch/" title="Text Search" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/textsearch/">
        Text Search
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/transactions/" title="Transactions" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/transactions/">
        Transactions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/updating/" title="Updating" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/updating/">
        Updating
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/2.0.0-SNAPSHOT/guides/validationextension/" title="Validation Extension" class="dd-item ">
        <a href="/2.0.0-SNAPSHOT/guides/validationextension/">
        Validation Extension
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="/2.0.0-SNAPSHOT/javadoc"><i class='fas fa-book'></i> API Documentation</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/MorphiaOrg/morphia"><i class='fab fa-fw fa-github'></i> Source Code</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                   Querying 
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#creating-a-query">Creating a Query</a>
      <ul>
        <li><a href="#filter"><code>filter()</code></a></li>
      </ul>
    </li>
    <li><a href="#complex-queries">Complex Queries</a></li>
    <li><a href="#other-query-options">Other Query Options</a>
      <ul>
        <li><a href="#projections">Projections</a></li>
        <li><a href="#limiting-and-skipping">Limiting and Skipping</a></li>
        <li><a href="#ordering">Ordering</a></li>
        <li><a href="#tailable-cursors">Tailable Cursors</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Querying
            </h1>
          

        



<h2 id="creating-a-query">Creating a Query</h2>
<p>Morphia provides <code>Query&lt;T&gt;</code> class to build a query and map the results back to instances of your entity classes and attempts
to provide as much type safety and validation as possible.  To create the <code>Query</code>, we invoke the following code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Query<span style="color:#f92672">&lt;</span>Product<span style="color:#f92672">&gt;</span> query <span style="color:#f92672">=</span> datastore<span style="color:#f92672">.</span><span style="color:#a6e22e">find</span><span style="color:#f92672">(</span>Product<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</code></pre></div><p><code>find()</code> returns an instance of <code>Query</code> which we can use to build a query.</p>
<h3 id="filter"><code>filter()</code></h3>
<p>The most significant method <code>filter(Filter...)</code>.  This method takes a number of filters to apply to the query being built.  The
filters are added to any existing, previously defined filters so you needn&rsquo;t add them all at once.  There are dozens of filters
predefined in Morphia and can be found in the <code>dev.morphia.query.experimental.filters</code> package.</p>

<div class="notices note" ><p>The package is currently <code>experimental</code>.  This done to signify that this API is a new one and might change based on user feedback
prior to a final release.  It is expected that the API will be largely the same in the final release and you are highly encouraged
to try it out before then.  If you encounter and bugs or usability issues, please file an
<a href="https://github.com/MorphiaOrg/morphia/issues">issue</a></p>
</div>

<p>The filters can be accessed via the <a href="/2.0.0-SNAPSHOT/javadoc?dev/morphia/query/experimental/filters/Filters.html
">Filters</a> class.  The method names
largely match the operation name you would use querying via the mongo shell so this should help you translate queries in to Morphia&rsquo;s
API.  For example, to query for products whose prices is greater than or equal to 1000, you would write this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">query<span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span>Filters<span style="color:#f92672">.</span><span style="color:#a6e22e">gte</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;price&#34;</span><span style="color:#f92672">,</span> 1000<span style="color:#f92672">));</span>
</code></pre></div><p>This will append the new criteria to any existing criteria already defined.  You can define as many filters in one call as you&rsquo;d like or
you may choose to append them in smaller groups based on whatever query building logic your application might have.</p>
<h2 id="complex-queries">Complex Queries</h2>
<p>Of course, queries are usually more complex than single field comparisons.  Morphia offers both <code>and()</code> and <code>or()</code> to build up more
complex queries.  An <code>and</code> query might look something like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">q<span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span>and<span style="color:#f92672">(</span>
    eq<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;width&#34;</span><span style="color:#f92672">,</span> 10<span style="color:#f92672">),</span> 
    eq<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;height&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">)));</span>
</code></pre></div><p>An <code>or</code> clause looks exactly the same except for using <code>or()</code> instead of <code>and()</code>, of course.  The default is to &ldquo;and&rdquo; filter criteria
together so if all you need is an <code>and</code> clause, you don&rsquo;t need an explicit call to <code>and()</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">datastore<span style="color:#f92672">.</span><span style="color:#a6e22e">find</span><span style="color:#f92672">(</span>UserLocation<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">(</span>
        lt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;x&#34;</span><span style="color:#f92672">,</span> 5<span style="color:#f92672">),</span>
        gt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;y&#34;</span><span style="color:#f92672">,</span> 4<span style="color:#f92672">),</span>
        gt<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;z&#34;</span><span style="color:#f92672">,</span> 10<span style="color:#f92672">));</span>
</code></pre></div><p>This generates an implicit <code>and</code> across the field comparisons.</p>
<h2 id="other-query-options">Other Query Options</h2>
<p>There is more to querying than simply filtering against different document values.  Listed below are some of the options for modifying
the query results in different ways.</p>
<h3 id="projections">Projections</h3>
<p><a href="http://docs.mongodb.org/manual/tutorial/project-fields-from-query-results/
">Projections</a> allow you to return only a subset of the fields in a
document.  This is useful when you need to only return a smaller view of a larger object.  Borrowing from the <a href="https://github.com/MorphiaOrg/morphia/blob/master/morphia/src/test/java/dev/morphia/TestQuery.java
">unit tests</a>, this is an example of this feature in action:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">ContainsRenamedFields user <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ContainsRenamedFields<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Frank&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Zappa&#34;</span><span style="color:#f92672">);</span>
datastore<span style="color:#f92672">.</span><span style="color:#a6e22e">save</span><span style="color:#f92672">(</span>user<span style="color:#f92672">);</span>

ContainsRenamedFields found <span style="color:#f92672">=</span> datastore
                                  <span style="color:#f92672">.</span><span style="color:#a6e22e">find</span><span style="color:#f92672">(</span>ContainsRenamedFields<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
                                  <span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FindOptions<span style="color:#f92672">()</span>
                                               <span style="color:#f92672">.</span><span style="color:#a6e22e">projection</span><span style="color:#f92672">().</span><span style="color:#a6e22e">include</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;first_name&#34;</span><span style="color:#f92672">)</span>
                                               <span style="color:#f92672">.</span><span style="color:#a6e22e">limit</span><span style="color:#f92672">(</span>1<span style="color:#f92672">))</span>
                                  <span style="color:#f92672">.</span><span style="color:#a6e22e">tryNext</span><span style="color:#f92672">();</span>
assertNotNull<span style="color:#f92672">(</span>found<span style="color:#f92672">.</span><span style="color:#a6e22e">firstName</span><span style="color:#f92672">);</span>
assertNull<span style="color:#f92672">(</span>found<span style="color:#f92672">.</span><span style="color:#a6e22e">lastName</span><span style="color:#f92672">);</span>
</code></pre></div><p>As you can see here, we&rsquo;re saving this entity with a first and last name but our query only returns the first name (and the <code>_id</code> value) in
the returned instance of our type.  It&rsquo;s also worth noting that this project works with both the mapped document field name
<code>&quot;first_name&quot;</code> and the Java field name <code>&quot;firstName&quot;</code>.</p>

<div class="notices warn" ><p>While projections can be a nice performance win in some cases, it&rsquo;s important to note that this object can not be safely saved back to
MongoDB.  Any fields in the existing document in the database that are missing from the entity will be removed if this entity is
saved. For example, in the example above if <code>found</code> is saved back to MongoDB, the <code>last_name</code> field that currently exists in the database
for this entity will be removed.  To save such instances back consider using <a href="/2.0.0-SNAPSHOT/javadoc?dev/morphia/Datastore#merge-T-.html"><code>Datastore#merge(T)</code></a></p>
</div>

<h3 id="limiting-and-skipping">Limiting and Skipping</h3>
<p>Pagination of query results is often done as a combination of skips and limits.  Morphia offers <code>FindOptions.limit(int)</code> and
<code>FindOptions.offset(int)</code> for these cases.  An example of these methods in action would look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">datastore<span style="color:#f92672">.</span><span style="color:#a6e22e">createQuery</span><span style="color:#f92672">(</span>Person<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">.</span><span style="color:#a6e22e">asList</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FindOptions<span style="color:#f92672">()</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">offset</span><span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>
	    <span style="color:#f92672">.</span><span style="color:#a6e22e">limit</span><span style="color:#f92672">(</span>10<span style="color:#f92672">))</span>
</code></pre></div><p>This query will skip the first element and take up to the next 10 items found by the query.  There&rsquo;s a caveat to using skip/limit for
pagination, however.  See the <a href="http://docs.mongodb.org/manual/reference/method/cursor.skip
">skip</a> documentation for more detail.</p>
<h3 id="ordering">Ordering</h3>
<p>Ordering the results of a query is done via <a href="/javadoc/dev/morphia/query/Query.html#order-java.lang.String-"><code>FindOptions.sort(Sort...)</code></a>
and a handful of other overloads. For example, to sort by <code>age</code> (youngest to oldest) and then <code>income</code> (highest to lowest), you would
use this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">getDs<span style="color:#f92672">().</span><span style="color:#a6e22e">find</span><span style="color:#f92672">(</span>User<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
       <span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FindOptions<span style="color:#f92672">()</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">sort</span><span style="color:#f92672">(</span>ascending<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">),</span> descending<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;income&#34;</span><span style="color:#f92672">))</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">limit</span><span style="color:#f92672">(</span>1<span style="color:#f92672">))</span>
       <span style="color:#f92672">.</span><span style="color:#a6e22e">tryNext</span><span style="color:#f92672">();</span>
</code></pre></div><h3 id="tailable-cursors">Tailable Cursors</h3>
<p>If you have a <a href="http://docs.mongodb.org/manual/core/capped-collections/
">capped collection</a> it&rsquo;s possible to &ldquo;tail&rdquo; a query so that when new documents
are added to the collection that match your query, they&rsquo;ll be returned by the <a href="http://docs.mongodb.org/manual/reference/glossary/#term-tailable-cursor
">tailable cursor</a>.  An example of this feature in action can be found in the <a href="https://github.com/MorphiaOrg/morphia/blob/master/morphia/src/test/java/dev/morphia/TestQuery.java
">unit tests</a> in the <code>testTailableCursors()</code> test:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">getMorphia<span style="color:#f92672">().</span><span style="color:#a6e22e">map</span><span style="color:#f92672">(</span>CappedPic<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
getDs<span style="color:#f92672">().</span><span style="color:#a6e22e">ensureCaps</span><span style="color:#f92672">();</span>                                                          <span style="color:#75715e">// #1
</span><span style="color:#75715e"></span><span style="color:#66d9ef">final</span> Query<span style="color:#f92672">&lt;</span>CappedPic<span style="color:#f92672">&gt;</span> query <span style="color:#f92672">=</span> getDs<span style="color:#f92672">().</span><span style="color:#a6e22e">createQuery</span><span style="color:#f92672">(</span>CappedPic<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
<span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>CappedPic<span style="color:#f92672">&gt;</span> found <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>

<span style="color:#66d9ef">final</span> Iterator<span style="color:#f92672">&lt;</span>CappedPic<span style="color:#f92672">&gt;</span> tail <span style="color:#f92672">=</span> query<span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> FindOptions<span style="color:#f92672">()</span>
                                                   <span style="color:#f92672">.</span><span style="color:#a6e22e">cursorType</span><span style="color:#f92672">(</span>CursorType<span style="color:#f92672">.</span><span style="color:#a6e22e">Tailable</span><span style="color:#f92672">));</span>
<span style="color:#66d9ef">while</span><span style="color:#f92672">(</span>found<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">()</span> <span style="color:#f92672">&lt;</span> 10<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
	found<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>tail<span style="color:#f92672">.</span><span style="color:#a6e22e">next</span><span style="color:#f92672">());</span>                                                    <span style="color:#75715e">// #2
</span><span style="color:#75715e"></span><span style="color:#f92672">}</span>
</code></pre></div><p>There are two things to note about this code sample:</p>
<ol>
<li>This tells Morphia to make sure that any entity <a href="/guides/annotations/#entity">configured</a> to use a capped collection has its collection
created correctly.  If the collection already exists and is not capped, you will have to manually <a href="http://docs.mongodb.org/manual/core/capped-collections/#convert-a-collection-to-capped
">update</a> your collection to be a capped collection.</li>
<li>Since this <code>Iterator</code> is backed by a tailable cursor, <code>hasNext()</code> and <code>next()</code> will block until a new item is found.  In this
version of the unit test, we tail the cursor waiting to pull out objects until we have 10 of them and then proceed with the rest of the
application.</li>
</ol>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/2.0.0-SNAPSHOT/js/clipboard.min.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/perfect-scrollbar.min.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/perfect-scrollbar.jquery.min.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/jquery.sticky.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/featherlight.min.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/highlight.pack.js?1584105437"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/2.0.0-SNAPSHOT/js/modernizr.custom-3.6.0.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/learn.js?1584105437"></script>
    <script src="/2.0.0-SNAPSHOT/js/hugo-learn.js?1584105437"></script>

    <link href="/2.0.0-SNAPSHOT/mermaid/mermaid.css?1584105437" rel="stylesheet" />
    <script src="/2.0.0-SNAPSHOT/mermaid/mermaid.js?1584105437"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

